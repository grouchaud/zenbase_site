var $body=$(document.body);var _$screenshots=$("#screenshots"),_header_carousel_active=true,_header_advance_interval=false,_HEADER_ADVANCE_PERIOD_MS=5e3;var _$ways_container=$("#communicate"),_ways_advance_interval=false,_WAYS_ADVANCE_PERIOD_MS=5e3;var _SCROLL_FIXED_CUTOFF=_SCROLL_FIXED_CUTOFF||($(window).height()>=825?300:75),_HEADER_HEIGHT=_HEADER_HEIGHT||825;var _HAS_STORY=_HAS_STORY;var _FROM_SUBDOMAIN=_FROM_SUBDOMAIN;var _convertro_id=0;if($body.scrollTop()>=_SCROLL_FIXED_CUTOFF&&!$("nav.top[data-no-scroll]").length){_header_carousel_active=false;if(!$body.hasClass("scrolled")){$body.addClass("scrolled")}}$(window).scroll(function(e){if($("nav.top[data-no-scroll]").length)return;if(this.pageYOffset>=_SCROLL_FIXED_CUTOFF&&!$body.hasClass("scrolled")){$body.addClass("scrolled")}else if(this.pageYOffset<_SCROLL_FIXED_CUTOFF&&$body.hasClass("scrolled")){$body.removeClass("scrolled")}if(this.pageYOffset>=_HEADER_HEIGHT){_header_carousel_active=false}else{_header_carousel_active=true}});$(window).load(function(){window.$CVO=window.$CVO||[];window.$CVO.push(["getCode",function(convertro_id){_convertro_id=convertro_id}]);$("nav.mobile_menu").removeClass("loading");$("[data-srcset]").each(function(i){$(this).attr("srcset",$(this).attr("data-srcset"))});$("[data-src]").each(function(i){$(this).attr("src",$(this).attr("data-src"))});$("[data-defer-bg]").each(function(i){$(this).removeAttr("data-defer-bg")});if(_$screenshots.length)_startHeaderAutoAdvance();if(_$ways_container.length)_startWaysAutoAdvance();$("#story_scroll").on("click",function(){var animate_to;if($(".top_ad_header_mobile").length>0&&$(window).width()<=640){animate_to=$(".top_ad_header_mobile")}else if($("header").length>0){animate_to=$("header")}else{animate_to=$("#page")}$("html, body").animate({scrollTop:animate_to.offset().top-$("nav.top").height()},250)});var query_story=_getQueryVariable("story");var query_slide=_getQueryVariable("s");var query_cta_bottom=_getQueryVariable("cta_bottom");if(_getQueryVariable("hp_debug")!=="1"){setTimeout(function(){if(_getQueryVariable("reset_cookie")==="1"){eraseCookie("lp_nt",".slack.com")}else if(_getQueryVariable("story")==="marsandbeyond"){history.replaceState({},"story","/")}else if(_getQueryVariable("story")==="openforbusiness"){history.replaceState({},"story","/")}else if(_getQueryVariable("story")==="neutrinoinahaystack"){history.replaceState({},"story","/")}else if(_getQueryVariable("clean")==="1"){history.replaceState({},"clean","/")}},bowser.msie?200:0)}var hp_version_perf;if(query_story){hp_version_perf="slide_"+(query_slide?query_slide:"0")+"_cta_"+(query_cta_bottom?query_cta_bottom:"0")}else{hp_version_perf="control"}if(landing.perf_beacon_prefix){TSMeasureAndBeacon(landing.perf_beacon_prefix+"_load","start_load");TSMeasureAndBeacon(landing.perf_beacon_prefix+"_total_load","start_nav");TSMeasureAndBeacon(landing.perf_beacon_prefix+"_"+hp_version_perf+"_load","start_load")}});$("#screenshots .switcher a").click(function(e){e.preventDefault();e.stopPropagation();_stopHeaderAutoAdvance();$("#screenshots").attr("data-highlight",$(this).data("highlight"))});$("#screenshots").click(function(){_stopHeaderAutoAdvance();_moveHeaderCarouselRight()});$(document).keydown(function(e){if(!_header_carousel_active)return;switch(e.which){case 37:_stopHeaderAutoAdvance();_moveHeaderCarouselLeft();break;case 39:_stopHeaderAutoAdvance();_moveHeaderCarouselRight();break}});$("#communicate .way").click(function(e){if($(document).width()<=945)return;e.stopPropagation();_stopWaysAutoAdvance();$("#communicate").attr("data-highlight",$(this).data("highlight"))});$("#communicate .switcher a").click(function(e){e.preventDefault();e.stopPropagation();_stopWaysAutoAdvance();$("#communicate").attr("data-highlight",$(this).data("highlight"))});$("#communicate").click(function(e){_stopWaysAutoAdvance();_moveWaysForward()});$(".cta_track").on("click",function(e){e.preventDefault();$(this).append('<form id="cta_submit" action="'+landing.root_url+'create" method="post" type="hidden"></form>');var $form=$("#cta_submit");$form.submit()});$(".cta_form").on("submit",function(e){e.preventDefault();var $form=$(this);var $email=$(".input_email",$(this));var email_str=$.trim($email.val()).replace(/[\u200B-\u200D\uFEFF]/g,"");var email_regex=new RegExp("^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$","i");var error_msg,error_color;var d=$.Deferred();d.fail(function(){_addToolTip($form.find(".cta_input_email_wrapper"),error_msg,error_color)});if(!email_str){error_msg="Please fill out your email address!";return d.reject(error_msg)}if(!email_regex.test(email_str)){error_msg="Oops! That looks like an invalid email address!";return d.reject(error_msg)}window.callSlackAPIUnauthed("signup.checkEmail",{email:email_str},function(ok,data,args){if(ok){return d.resolve()}if(data.error==="bad_email_domain"){var email_domain=email_str.split("@")[1];error_msg="Sorry, but we do not allow signups from @"+email_domain+'.<br class="hide_on_mobile"> Please pick a different email address!';error_color="red"}else{error_msg="Sorry, you've hit the rate limit.<br class=\"hide_on_mobile\"> You'll be able to try again soon.";error_color="red"}return d.reject()});d.then(function(){$form.off("submit");$form.submit()})});function _addToolTip($input_wrapper,error_msg,error_color){error_color=error_color||"orange";var $ts_tip_tip=$input_wrapper.find(".ts_tip_tip");var $input_email=$input_wrapper.find(".input_email");if(!$ts_tip_tip.length){$ts_tip_tip=$('<span class="ts_tip_tip"><span class="ts_tip_multiline_inner">'+error_msg+"</span></span>");$input_wrapper.addClass("ts_tip ts_tip_top ts_tip_float ts_tip_hide ts_tip_multiline").append($ts_tip_tip);$input_email.on("input",function(){$input_wrapper.addClass("ts_tip_hide")});setTimeout(function(){$input_wrapper.removeClass("ts_tip_hide")},0)}else{$input_wrapper.removeClass("ts_tip_hide").find(".ts_tip_multiline_inner").html(error_msg)}$ts_tip_tip.attr("data-color",error_color);$input_email.focus()}function _moveHeaderCarouselRight(){if(!_header_carousel_active)return;var current=_$screenshots.attr("data-highlight");switch(current){case"channels":_$screenshots.attr("data-highlight","integrations");break;case"integrations":_$screenshots.attr("data-highlight","search");break;case"search":_$screenshots.attr("data-highlight","channels");break}}function _moveHeaderCarouselLeft(){if(!_header_carousel_active)return;var current=_$screenshots.attr("data-highlight");switch(current){case"channels":_$screenshots.attr("data-highlight","search");break;case"integrations":_$screenshots.attr("data-highlight","channels");break;case"search":_$screenshots.attr("data-highlight","integrations");break}}function _startHeaderAutoAdvance(){if(!_header_advance_interval){_header_advance_interval=setInterval(_moveHeaderCarouselRight,_HEADER_ADVANCE_PERIOD_MS)}}function _stopHeaderAutoAdvance(){clearInterval(_header_advance_interval);_header_advance_interval=false}function _moveWaysForward(){if(!_header_carousel_active)return;var current=_$ways_container.attr("data-highlight");switch(current){case"channel":_$ways_container.attr("data-highlight","group");break;case"dm":_$ways_container.attr("data-highlight","channel");break;case"group":_$ways_container.attr("data-highlight","dm");break}}function _moveWaysBack(){if(!_header_carousel_active)return;var current=_$ways_container.attr("data-highlight");switch(current){case"channel":_$ways_container.attr("data-highlight","dm");break;case"dm":_$ways_container.attr("data-highlight","group");break;case"group":_$ways_container.attr("data-highlight","channel");break}}function _startWaysAutoAdvance(){if(!_ways_advance_interval){_ways_advance_interval=setInterval(_moveWaysForward,_WAYS_ADVANCE_PERIOD_MS)}}function _stopWaysAutoAdvance(){clearInterval(_ways_advance_interval);_ways_advance_interval=false}function _getQueryVariable(variable){var query=window.location.search.substring(1);var vars=query.split("&");for(var i=0;i<vars.length;i++){var pair=vars[i].split("=");if(pair[0]==variable)return pair[1]}return false}var landing={underline:{},has_complete_typewrite:false,experiment_id:"0",variation_id:"0",variation_name:"0",has_optimizely:typeof window.optimizely!="undefined",is_bucket_optimizely:false,init:function(){var gtmDataLayer=window.dataLayer||[];var optimizely=window.optimizely||[];if(landing.has_optimizely){if(optimizely.hasOwnProperty("activeExperiments")){var state=optimizely.data.state;if(typeof state!="undefined"){if(optimizely.activeExperiments.length>0){landing.experiment_id=optimizely.activeExperiments[0];landing.variation_id=state.variationIdsMap[landing.experiment_id][0];landing.variation_name=state.variationNamesMap[landing.experiment_id]}else if(typeof state.redirectExperiment!="undefined"){landing.experiment_id=state.redirectExperiment.experimentId;landing.variation_id=state.redirectExperiment.variationId;landing.variation_name=optimizely.variationNamesMap[landing.experiment_id]}}var experiment_cookie={experiment_id:landing.experiment_id,variation_id:landing.variation_id,variation_name:landing.variation_name,convertro_id:_convertro_id};createCookie("experiment",JSON.stringify(experiment_cookie),365,"slack.com")}}$(".opt_cta_signin").on("click",function(e){optimizely.push(["trackEvent","cta_signin"])});$(".opt_nav_signin").on("click",function(e){optimizely.push(["trackEvent","nav_signin"])});$(".opt_cta_find, .opt_nav_find").on("click",function(e){optimizely.push(["trackEvent","find"])});if(_getQueryVariable("story")||landing.story_name){landing.preloadImage();if($(window).width()<641){$(".typed_remove").addClass("hidden");landing.completeTypewrite()}}landing.createRotationList()},preloadImage:function(){var story_query=_getQueryVariable("story")||landing.story_name;var header_img;if(story_query=="marsandbeyond"){header_img="nasa-header-image"}else if(story_query=="neutrinoinahaystack"){header_img="neutrino-observatory-header-image"}else if(story_query=="decodingdna"){header_img="macarthur-lab-header-image"}else if(story_query=="brewbetter"){header_img="blue-bottle-header"}else if(story_query=="openforbusiness"){header_img="square-header-image"}else{landing.startAnimation();return}var image=new Image;image.onload=function(){setTimeout(landing.startAnimation,2400)};image.src="/img/wired/"+header_img+"@tiny.jpg"},startAnimation:function(){landing.typewrite(27)},typewrite:function(speed){$(".typed_remove").addClass("hidden");$(".typewriter").typed({strings:[$(".typewriter_copy").html()],typeSpeed:speed,callback:landing.completeTypewrite})},completeTypewrite:function(){if(landing.has_complete_typewrite)return;landing.underline.robots_path=bowser.msie?$(".underline_robots_image"):$(".underline_robots_path");landing.underline.mars_path=bowser.msie?$(".underline_mars_image"):$(".underline_mars_path");landing.underline.robots=$(".underline_robots");landing.underline.mars=$(".underline_mars");landing.underline.robots.append(landing.underline.robots_path);landing.underline.mars.append(landing.underline.mars_path);$(".typed-cursor").addClass("hide");$body.addClass("start_animation");landing.has_complete_typewrite=true},createRotationList:function(){var list=["neutrinoinahaystack","waterislife","marsandbeyond"];if(readCookie("lp_l")){list=readCookie("lp_l");list=list.split(",");list.push(list.shift())}createCookie("lp_l",list,365,"slack.com")}};$(landing.init);